# Wheelchair Rugby Lineup Optimizer

A data-driven lineup optimization system for wheelchair rugby using Regularized Adjusted Plus-Minus (RAPM) and Mixed Integer Linear Programming.

## Overview

This application helps coaches select optimal 4-player lineups based on:
- **Individual player values** calculated using Bayesian RAPM
- **Game state** (score differential, time remaining)
- **Fatigue modeling** based on minutes played
- **Mobility constraints** (total classification ≤ 8.0 points)

## Features

- **RAPM Player Valuation**: Estimates offensive and defensive contributions for each player
- **Dynamic Strategy**: Automatically adjusts offensive/defensive priorities based on score
- **Fatigue Penalties**: Accounts for player tiredness over the course of a game
- **Gurobi Optimization**: Uses MILP to find the optimal lineup given constraints
- **Interactive Web App**: Clean Streamlit interface for real-time lineup recommendations

## Project Structure

```
WCR/
├── app.py              # Streamlit web application
├── optimizer.py        # Core optimization functions
├── analysis.ipynb      # Jupyter notebook with full analysis
├── requirements.txt    # Python dependencies
├── METHODOLOGY.md      # Detailed methodology documentation
└── data/
    ├── stint_data.csv      # Raw stint-level game data
    ├── player_data.csv     # Player mobility ratings
    └── player_values.csv   # Calculated RAPM values (generated by notebook)
```

## Installation

### 1. Clone the repository
```bash
git clone <your-repo-url>
cd WCR
```

### 2. Create and activate virtual environment
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

### 3. Install dependencies
```bash
pip install -r requirements.txt
```

### 4. Set up Gurobi License
The optimizer uses Gurobi for MILP. You need a valid Gurobi license:
- Academic licenses are free at [gurobi.com](https://www.gurobi.com/academia/academic-program-and-licenses/)
- Follow Gurobi's instructions to activate your license

## Usage

### Running the Web App
```bash
streamlit run app.py
```

Then open http://localhost:8501 in your browser.

### Using the App

1. **Select Teams**: Choose home and away teams, then click "Start Game"
2. **Add Stint Data**: Select 4 players, enter goals scored, and click "Add Stint"
3. **Get Recommendations**: Click "Get Optimal Lineup" to see the recommended lineup
4. **View Strategy**: The app shows offensive/defensive weights based on score differential

### Running the Analysis Notebook
```bash
jupyter notebook analysis.ipynb
```

The notebook contains:
- Data exploration and preprocessing
- RAPM model fitting
- Parameter justification analysis
- Optimization examples

## Model Details

### RAPM (Regularized Adjusted Plus-Minus)
- Estimates individual player contributions from team-level stint data
- Uses Ridge regression with L2 regularization
- Produces offensive (O-RAPM) and defensive (D-RAPM) ratings

### Dynamic Weighting
- Offensive weight increases when losing (need to score)
- Defensive weight increases when winning (protect lead)
- Formula: `offensive_weight = 0.5 + (-goal_diff / max_diff) * 0.5`

### Fatigue Model
- Linear penalty based on minutes played
- Up to 10% reduction at 8+ minutes
- Encourages player rotation

### Optimization
- Binary Integer Linear Program (BILP)
- Constraint: Total classification ≤ 8.0
- Objective: Maximize weighted player value considering fatigue

## Requirements

- Python 3.8+
- Gurobi 12.0 (with valid license)
- See `requirements.txt` for full package list

## References

See `METHODOLOGY.md` for detailed algorithm explanations and citations.

## License

This project was developed for MSE 433 coursework.
